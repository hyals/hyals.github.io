<!DOCTYPE html>
<html lang="en" class="mdui-theme-light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>BEYOND THE DIVIDE</title>

  <!-- Icons -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons|Material+Icons+Outlined" />

  <!-- MDUI -->
  <link rel="stylesheet" href="https://unpkg.com/mdui@2/mdui.css" />
  <script src="https://unpkg.com/mdui@2/mdui.global.js" defer></script>

  <!-- Markdown parser -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js" defer></script>

  <style>
    :root {
      --thumb-size: 48px;
      --thumb-edge-gap: 12px;
      --accent: #6750A4;
      --surface: rgba(255, 255, 255, 0.82);
      --elevation: 0 8px 28px rgba(16, 16, 16, 0.18);
    }

    html, body {
      height: 100%;
      margin: 0;
      overflow: hidden;
      font-family: "Roboto", sans-serif;
    }

    main {
      max-width: 640px;
      margin: auto;
      padding: 4rem 2rem 8rem;
    }
    
    section,mdui-divider,mdui-card,mdui-list,.mt-1 {
      margin-top:1rem;
    }
    
    .mt-2 {
      margin-top:2rem;
    }
    
    mdui-card{
      width:100%;
      padding:1rem;
    }

    /* Scroll container */
    #scrollContainer {
      height: 100vh;
      overflow-y: scroll;
      margin: 0;
      padding: 0;
      scrollbar-width: none; /* Firefox */
      -ms-overflow-style: none; /* IE 10+ */
    }

    #scrollContainer::-webkit-scrollbar {
      display: none; /* Chrome, Safari, Edge */
    }

    /* Custom scrollbar */
    .scroll-track {
      position: fixed;
      right: -1em;
      top: 0;
      height: 100vh;
      width: var(--thumb-size);
      z-index: 1;
      transition: opacity 0.4s ease;
      opacity: 1;
    }

    .scroll-track.hidden {
      opacity: 0;
      pointer-events: none;
    }

    .scroll-thumb-wrap {
      position: absolute;
      right: 0;
      width: var(--thumb-size);
      height: var(--thumb-size);
    }

    .scroll-thumb {
      width: var(--thumb-size);
      height: var(--thumb-size);
      border-radius: 50%;
      background: var(--surface);
      box-shadow: var(--elevation);
      display: grid;
      place-items: center;
      backdrop-filter: blur(6px);
      border: none;
      cursor: grab;
      touch-action: none;
      transition: transform 0.15s cubic-bezier(.2, .9, .3, 1);
    }

    .scroll-thumb:active {
      cursor: grabbing;
    }

    .scroll-thumb svg {
      width: 100%;
      height: 100%;
    }

    .ring-bg {
      stroke: rgba(0, 0, 0, 0.08);
      stroke-width: 3;
      fill: none;
    }

    .ring {
      stroke: var(--accent);
      stroke-width: 3;
      stroke-linecap: round;
      fill: none;
      transform-origin: center;
      transform: rotate(-90deg);
    }

    /* Appbar */
    .appbar {
      display: flex;
      justify-content: center;
      position: fixed !important;
      top: 0;
      left: 0;
      right: 0;
      height: 4rem;
    }

    /* Layout helpers */
    .grid-2col {
      display: grid;
      grid-template-columns: 25% 75%;
      gap: 1rem;
    }

    .title-large {
      font-size: var(--mdui-typescale-title-large-size);
      display: block;
    }

    .title-medium {
      font-size: var(--mdui-typescale-title-medium-size);
      display: block;
    }

    .title-small {
      font-size: var(--mdui-typescale-title-small-size);
      display: block;
    }

    .character-avatar {
      border-radius: var(--mdui-shape-corner-large);
      width: 8rem;
      height: 8rem;
    }
  </style>
</head>
<body>
  <div id="scrollContainer">
    <main>
      <!-- Top App Bar -->
      <mdui-top-app-bar class="appbar"
        scroll-behavior="elevate"
        scroll-target="#scrollContainer">
        <mdui-button-icon icon="border_color"></mdui-button-icon>

        <mdui-top-app-bar-title>
          <span style="font-weight:400">hyals.ink</span><br>
        </mdui-top-app-bar-title>

        <div style="flex-grow:1"></div>

        <mdui-switch id="themeSwitch"
          unchecked-icon="wb_sunny--outlined"
          checked-icon="nightlight--outlined"
          title="Toggle theme"></mdui-switch>
      </mdui-top-app-bar>

      <div class="mdui-prose">
        <!-- Cover & Info -->
        <div class="grid-2col">
          <div>
            <img src="img/book_cover.webp" alt="BEYOND THE DIVIDE cover" />
          </div>
          <div>
            <span class="title-large">BEYOND THE DIVIDE</span>
            <span class="title-medium">even in a colorless world, children must go on.</span>
            <span class="title-small">by <a href="https://hyals.ink">hyaL-s</a> Â· 2025</span>
          </div>
        </div>

        <mdui-segmented-button-group style="width:100%" class="mt-2">
          <mdui-segmented-button icon="menu_book" href="ch">Read on hyals.ink</mdui-segmented-button>
          <mdui-segmented-button icon="open_in_new"
            href="https://www.scribblehub.com/series/1231858/beyond-the-divide/"
            target="_blank">Read on ScribbleHub</mdui-segmented-button>
        </mdui-segmented-button-group>

        <mdui-divider class="mt-2"></mdui-divider>

        <!-- Synopsis -->
        <section>
          <span class="title-large">About this work</span>
          <mdui-card variant="elevated">
            <p><strong>Synopsis</strong></p>
            <p>He is lost. He has nobody to trust. In this damned world where everyone forgets, the echoes of the past bring judgement even to those unaware of it.</p>

            <mdui-divider></mdui-divider>

            <p><strong>Genre</strong></p>
            <p>
              <mdui-chip>Fantasy</mdui-chip>
              <mdui-chip>Psychological</mdui-chip>
              <mdui-chip>Tragedy</mdui-chip>
            </p>

            <mdui-divider></mdui-divider>

            <table>
              <tbody>
                <tr><td>Format: Web Novel</td><td>Status: Ongoing</td></tr>
                <tr><td>Publisher: hyals.ink</td><td>Language: English</td></tr>
                <tr><td>Author: <a href="https://hyals.ink">hyaL-s</a></td><td></td></tr>
              </tbody>
            </table>
          </mdui-card>
        </section>

        <!-- Characters -->
        <section>
          <span class="title-large">Characters</span>
          <mdui-list>
            <mdui-list-item>
              Cien
              <mdui-avatar slot="icon" src="img/character/cien.webp" alt="Cien" class="character-avatar"></mdui-avatar>
              <span slot="description">A man of denial. He is the current vessel for God's Soul Fragment and the head of the Royal Family.</span>
            </mdui-list-item>

            <mdui-list-item>
              Balint
              <mdui-avatar slot="icon" src="img/character/balint.webp" alt="Balint" class="character-avatar"></mdui-avatar>
              <span slot="description">A man with a dream. He is the head of the Defense Forces and the founder of the Angel-Human Alliance Council.</span>
            </mdui-list-item>

            <mdui-list-item>
              Hya
              <mdui-avatar slot="icon" src="img/character/hya.webp" alt="Hya" class="character-avatar"></mdui-avatar>
              <span slot="description">A boy bound to the past. He is discriminated against due to sharing traits similar to that of demons.</span>
            </mdui-list-item>

            <mdui-list-item>
              Lina
              <mdui-avatar slot="icon" src="img/character/lina.webp" alt="Lina" class="character-avatar"></mdui-avatar>
              <p slot="description">A boy with resolve. He is next in line to inherit God's Soul Fragment.</p>
            </mdui-list-item>

            <mdui-list-item>
              Vita
              <mdui-avatar slot="icon" src="img/character/vita.webp" alt="Vita" class="character-avatar"></mdui-avatar>
              <span slot="description">A girl of yearning. She is an orphan taken in by the Royal Family after losing her parents during the Second Impact.</span>
            </mdui-list-item>

            <mdui-list-item>
              Gaukel
              <mdui-avatar slot="icon" src="img/character/gaukel.webp" alt="Gaukel" class="character-avatar"></mdui-avatar>
              <span slot="description">A boy with innocence. Lost in thought.</span>
            </mdui-list-item>
          </mdui-list>
        </section>
      </div>
    </main>
  </div>

  <!-- Custom Scrollbar -->
  <div id="scrollTrack" class="scroll-track">
    <div id="thumbWrap" class="scroll-thumb-wrap">
      <button id="thumb" class="scroll-thumb">
        <svg viewBox="0 0 40 40">
          <circle class="ring-bg" cx="20" cy="20" r="14"></circle>
          <circle id="ring" class="ring" cx="20" cy="20" r="14"></circle>
        </svg>
      </button>
    </div>
  </div>

  <!-- Custom scrollbar logic -->
  <script defer>
    (() => {
      const wrap = document.getElementById('thumbWrap'),
            thumb = document.getElementById('thumb'),
            track = document.getElementById('scrollTrack'),
            ring = document.getElementById('ring'),
            container = document.getElementById('scrollContainer');

      const R = 14, circumference = 2 * Math.PI * R;
      ring.style.strokeDasharray = circumference;

      let isDragging = false, hideTimeout, targetRatio = 0, animating = false;

      const available = () => window.innerHeight - 48 - 24;

      const showThumb = () => {
        track.classList.remove('hidden');
        clearTimeout(hideTimeout);
        hideTimeout = setTimeout(() => track.classList.add('hidden'), 3000);
      };

      const pointerToRatio = y => Math.min(1, Math.max(0, (y - 12) / available()));

      const setTargetRatio = ratio => {
        targetRatio = Math.min(1, Math.max(0, ratio));
        if (!animating) requestAnimationFrame(animateThumb);
      };

      const animateThumb = () => {
        animating = true;
        const scrollHeight = container.scrollHeight - container.clientHeight;
        const currentRatio = scrollHeight ? container.scrollTop / scrollHeight : 0;
        const delta = targetRatio - currentRatio;
        if (Math.abs(delta) < 0.001) {
          container.scrollTop = scrollHeight * targetRatio;
          animating = false;
          return;
        }
        container.scrollTop = scrollHeight * (currentRatio + delta * 0.3);
        updateThumb();
        requestAnimationFrame(animateThumb);
      };

      const updateThumb = () => {
        const scrollTop = container.scrollTop;
        const scrollHeight = container.scrollHeight - container.clientHeight;
        const ratio = scrollHeight ? scrollTop / scrollHeight : 0;
        wrap.style.transform = `translateY(${12 + available() * ratio}px)`;
        ring.style.strokeDashoffset = circumference * (1 - ratio);
      };

      const dragMove = y => setTargetRatio(pointerToRatio(y));

      const dragStart = e => {
        isDragging = true;
        thumb.setPointerCapture?.(e.pointerId);
        thumb.style.transition = 'none';
      };

      const dragEnd = e => {
        isDragging = false;
        thumb.releasePointerCapture?.(e?.pointerId);
        thumb.style.transition = 'transform 0.15s cubic-bezier(.2, .9, .3, 1)';
      };

      container.addEventListener('scroll', () => { if(!isDragging) updateThumb(); showThumb(); });
      window.addEventListener('resize', () => { updateThumb(); showThumb(); });

      thumb.addEventListener('pointerdown', dragStart);
      document.addEventListener('pointermove', e => isDragging && dragMove(e.clientY));
      document.addEventListener('pointerup', dragEnd);

      thumb.addEventListener('touchstart', e => { if(e.touches.length===1){ isDragging=true; thumb.style.transition='none'; } }, {passive:true});
      document.addEventListener('touchmove', e => { if(isDragging && e.touches.length===1) dragMove(e.touches[0].clientY); }, {passive:false});
      document.addEventListener('touchend', dragEnd);

      track.addEventListener('pointerdown', e => { if(e.target!==thumb){ dragMove(e.clientY); isDragging=true; thumb.setPointerCapture?.(e.pointerId); } });

      document.addEventListener('wheel', e => {
        if(!container.contains(e.target)){
          container.scrollTop += e.deltaY;
          setTargetRatio(container.scrollTop / (container.scrollHeight - container.clientHeight));
          showThumb();
          e.preventDefault();
        }
      }, {passive:false});

      ['pointermove','pointerdown','keydown','touchmove','touchstart'].forEach(evt => document.addEventListener(evt, showThumb));

      setTargetRatio(0);
      showThumb();
    })();
  </script>

  <!-- Theme handling -->
  <script defer>
    function setCookie(name, value, days = 365) {
      const d = new Date();
      d.setTime(d.getTime() + days * 864e5);
      document.cookie = `${name}=${encodeURIComponent(value)};expires=${d.toUTCString()};path=/`;
    }

    function getCookie(name) {
      return document.cookie.split(';').map(c => c.trim())
        .find(c => c.startsWith(name + '='))?.split('=').slice(1).join('=') || null;
    }

    function toggleThemeBySwitch(isChecked) {
      const doc = document.documentElement;
      if (isChecked) {
        doc.classList.add('mdui-theme-dark');
        doc.classList.remove('mdui-theme-light');
        setCookie('theme', 'mdui-theme-dark');
      } else {
        doc.classList.remove('mdui-theme-dark');
        doc.classList.add('mdui-theme-light');
        setCookie('theme', 'mdui-theme-light');
      }
    }

    window.addEventListener('load', () => {
      const themeSwitch = document.getElementById('themeSwitch');
      themeSwitch.addEventListener('change', e => toggleThemeBySwitch(e.target.checked));

      const savedTheme = getCookie('theme');
      if (savedTheme === 'mdui-theme-dark') {
        document.documentElement.classList.add('mdui-theme-dark');
        themeSwitch.checked = true;
      } else {
        document.documentElement.classList.add('mdui-theme-light');
        themeSwitch.checked = false;
      }
    });
  </script>
</body>
</html>
